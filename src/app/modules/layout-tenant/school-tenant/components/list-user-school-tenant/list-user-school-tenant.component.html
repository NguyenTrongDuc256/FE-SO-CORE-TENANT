<div class="bg-white p-8 h-full border-radius-bg" *transloco="let t; scope: 'school'">
  <!-- start header -->
  <div class="d-flex algin-items-center justify-content-between flex-wrap">
    <h3 class="title-compo-global mb-3">{{t('school.listUser')}}</h3>
    <div class="filter d-flex flex-wrap algin-items-center">
      <ng-template ngxPermissionsOnly="{{ permission.school_manager }}">
        <button class="so-btn btn-import-export mx-2" (click)="export()" name="btn-export">
          <img src="assets/images/svg/export.svg" alt="">
          {{t('btnAction.export')}}
        </button>
      </ng-template>
      <select name="status" id="status" [(ngModel)]="isActive" class="so-select mx-2" (ngModelChange)="filter()">
        <option [value]="''">{{t('school.selectStatus')}}</option>
        <ng-container *ngFor="let status of arrStatusUser">
          <option [value]="status.value">{{status.label}}</option>
        </ng-container>
      </select>
      <select name="layout" id="layout" [(ngModel)]="layoutCode" class="so-select mx-2" (ngModelChange)="filter()">
        <option [value]="''">{{t('school.selectLayout')}}</option>
        <ng-container *ngFor="let layout of arrLayouts">
          <option [value]="layout.code">{{layout.name}}</option>
        </ng-container>
      </select>
      <div class="so-input-search mx-2">
        <nz-input-group [nzSuffix]="suffixIconSearch">
          <input type="text" name="input-search" nz-input placeholder="{{t('school.search')}}" #searchInput
            (keydown)="search($event, searchInput.value)" />
        </nz-input-group>
        <ng-template #suffixIconSearch>
          <img src="assets/images/svg/search.svg" alt="" nzType="search">
        </ng-template>
      </div>
    </div>
  </div>
  <!-- end header -->

  <!-- content -->
  <div class="mt-12">
    <table class="table-global w-full mb-4">
      <caption></caption>
      <thead>
        <th style="width: 4%;" class="text-header-table">
          {{t('STT')}}</th>
        <th style="width: 18%;" class="text-header-table">{{t('fullName')}}</th>
        <th style="width: 10%;" class="text-header-table">{{t('code')}} </th>
        <th style="width: 12%;" class="text-header-table">{{t('username')}} </th>
        <th style="width: 12%;" class="text-header-table">{{t('phone')}} </th>
        <th style="width: 15%;" class="text-header-table">{{t('email')}} </th>
        <th style="width: 9%;" class="text-header-table">{{t('role')}} </th>
        <th style="width: 12%;" class="text-header-table">{{t('status')}} </th>
        <ng-template ngxPermissionsOnly="{{ permission.school_manager }}">
          <th style="width: 8%;" class="text-header-table text-center"> {{t('action')}} </th>
        </ng-template>
      </thead>
      <tbody>
        <ng-container *ngFor="let item of arrList; let i=index">
          <tr>
            <td class="text-content-table">
              {{(pageIndex-1)*pageSize + i + 1}}
            </td>
            <td class="text-content-table">
              <span class="text-link fw-500">{{item.fullname}}</span>
            </td>
            <td>
              {{item.code}}
            </td>

            <td>
              {{item.username}}
            </td>
            <td>
              {{item.phone}}
            </td>
            <td>
              {{item.email}}
            </td>
            <td>
              <span class="fw-500 badge so-badge so-badge-status-1 cursor-pointer" (click)="viewModalListRole(item.id, item.fullname, false)"
                name="view-list">{{item.roleNumber}}</span>
            </td>
            <td>
              <span class="badge so-badge so-badge-status so-badge-status-{{item?.isActive}}">
                {{mapNameStatus(item?.isActive)}}
              </span>
            </td>
            <ng-template ngxPermissionsOnly="{{ permission.user_modify }}">
              <td class="text-center">
                <div class="d-flex justify-content-center">
                  <span nz-dropdown [nzDropdownMenu]="menu" nzTrigger="click"
                    class="so-btn-open-drop-menu so-btn-open-drop-menu-no-border d-flex align-items-center justify-content-center cursor-pointer" name="btn-open-menu">
                    <img src="assets/images/svg/three_vertical_dot_icon.svg" alt="">
                  </span>
                </div>
                <nz-dropdown-menu #menu="nzDropdownMenu" class="so-drop-menu">
                  <ul nz-menu>
                    <li nz-menu-item (click)="update(item.id, item)" class="d-flex align-items-center so-item-drop-menu"
                      name="btn-update">
                      <img src="assets/images/svg/write.svg" alt="">
                      {{t('btnAction.update')}}
                    </li>
                    <li nz-menu-item (click)="viewModalListRole(item.id, item.fullname, true)"
                      class="d-flex align-items-center so-item-drop-menu"
                      name="btn-view-list">
                      <img src="assets/images/svg/document3.svg" alt="">
                      {{t('school.listRole')}}
                    </li>
                    <li nz-menu-item (click)="assignRole(item.id)"
                      class="d-flex align-items-center so-item-drop-menu"
                      name="btn-view-list">
                      <img src="assets/images/svg/config_2_icon.svg" alt="">
                      {{t('school.assignRole')}}
                    </li>
                    <li nz-menu-item (click)="changePassword(item.id, item)"
                    class="d-flex align-items-center so-item-drop-menu"
                      name="btn-send-noti">
                      <img src="assets/images/svg/password.svg" alt="">
                      {{t('changePassword')}}
                    </li>
                    <li nz-menu-item (click)="changeStatusUser('lock', item.id, item.fullname)"
                    class="d-flex align-items-center so-item-drop-menu text-danger"
                      name="btn-lock"
                      *ngIf="item.isActive == 1">
                      <img src="assets/images/svg/lock11.svg" alt="">
                      {{t('school.lockUser')}}
                    </li>
                    <li nz-menu-item (click)="changeStatusUser('unlock', item.id, item.fullname)"
                    class="d-flex align-items-center so-item-drop-menu"
                      name="btn-unlock"
                      *ngIf="item.isActive == 0">
                      <img src="assets/images/svg/block_icon.svg" alt="">
                      {{t('school.unlockUser')}}
                    </li>
                    <li nz-menu-item (click)="changeStatusUser('delete', item.id, item.fullname)"
                    class="d-flex align-items-center so-item-drop-menu text-danger"
                      name="btn-delete">
                      <img src="assets/images/svg/delete6.svg" alt="">
                      {{t('school.deleteAccount')}}
                    </li>
                  </ul>
                </nz-dropdown-menu>
              </td>
            </ng-template>
          </tr>
        </ng-container>
        <tr *ngIf="arrList?.length == 0 || !arrList">
          <td class="text-no-data" colspan="9">{{t('noData')}}</td>
        </tr>
      </tbody>
    </table>

    <app-pagination [pageSize]="pageSize" [pageIndex]="pageIndex" [collectionSize]="collectionSize"
      *ngIf="collectionSize > sizeOption[0]" [sizeOption]="sizeOption" (paginationChange)="paginationChange($event)">
    </app-pagination>
  </div>
  <!-- end content -->
</div>

<div class="spinner" *ngIf="isLoading">
  <app-loading></app-loading>
</div>

<ng-container *transloco="let t; scope: 'role'">
  <div class="modal-header">
    <h5 class="title-modal-global">{{t(dataModal?.titleModal)}}</h5>
    <button type="button" class="close modal-btn-close" data-dismiss="modal" (click)="closeModal(false)"
      name="icon-close" [hidden]="dataModal?.isHiddenBtnClose">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <div class="mb-10">
      <span style="margin-right: 3rem;" class="fw-600">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M14.75 12.725V7.775C15.2 7.55 15.5 7.025 15.5 6.5C15.5 5.675 14.825 5 14 5C13.475 5 12.95 5.3 12.725 5.75H10.25V3.275C10.7 3.05 11 2.525 11 2C11 1.175 10.325 0.5 9.5 0.5C8.975 0.5 8.45 0.8 8.225 1.25H3.275C3.05 0.8 2.525 0.5 2 0.5C1.175 0.5 0.5 1.175 0.5 2C0.5 2.525 0.8 3.05 1.25 3.275V8.225C0.8 8.45 0.5 8.975 0.5 9.5C0.5 10.325 1.175 11 2 11C2.525 11 3.05 10.7 3.275 10.25H5.75V12.725C5.3 12.95 5 13.475 5 14C5 14.825 5.675 15.5 6.5 15.5C7.025 15.5 7.55 15.2 7.775 14.75H12.725C12.95 15.2 13.475 15.5 14 15.5C14.825 15.5 15.5 14.825 15.5 14C15.5 13.475 15.2 12.95 14.75 12.725ZM3.275 8.75C3.125 8.525 2.975 8.375 2.75 8.225V3.275C2.975 3.125 3.125 2.975 3.275 2.75H8.225C8.375 2.975 8.525 3.125 8.75 3.275V5.75H7.775C7.55 5.3 7.025 5 6.5 5C5.675 5 5 5.675 5 6.5C5 7.025 5.3 7.55 5.75 7.775V8.75H3.275ZM8.75 8.225C8.525 8.375 8.375 8.525 8.225 8.75H7.25V7.775C7.475 7.625 7.625 7.475 7.775 7.25H8.75V8.225ZM8.225 10.25C8.45 10.7 8.975 11 9.5 11C10.325 11 11 10.325 11 9.5C11 8.975 10.7 8.45 10.25 8.225V7.25H12.725C12.875 7.475 13.025 7.625 13.25 7.775V12.725C13.025 12.875 12.875 13.025 12.725 13.25H7.775C7.625 13.025 7.475 12.875 7.25 12.725V10.25H8.225Z"
            fill="#50A5F1" />
        </svg>
        <span style="margin-right: 1rem; margin-left: 8px;">{{t('role')}}:</span>
        <span class="text-link">{{dataFromParent.nameRole}}</span>
      </span>
      <span style="margin-right: 3rem;" class="fw-600">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M14.75 12.725V7.775C15.2 7.55 15.5 7.025 15.5 6.5C15.5 5.675 14.825 5 14 5C13.475 5 12.95 5.3 12.725 5.75H10.25V3.275C10.7 3.05 11 2.525 11 2C11 1.175 10.325 0.5 9.5 0.5C8.975 0.5 8.45 0.8 8.225 1.25H3.275C3.05 0.8 2.525 0.5 2 0.5C1.175 0.5 0.5 1.175 0.5 2C0.5 2.525 0.8 3.05 1.25 3.275V8.225C0.8 8.45 0.5 8.975 0.5 9.5C0.5 10.325 1.175 11 2 11C2.525 11 3.05 10.7 3.275 10.25H5.75V12.725C5.3 12.95 5 13.475 5 14C5 14.825 5.675 15.5 6.5 15.5C7.025 15.5 7.55 15.2 7.775 14.75H12.725C12.95 15.2 13.475 15.5 14 15.5C14.825 15.5 15.5 14.825 15.5 14C15.5 13.475 15.2 12.95 14.75 12.725ZM3.275 8.75C3.125 8.525 2.975 8.375 2.75 8.225V3.275C2.975 3.125 3.125 2.975 3.275 2.75H8.225C8.375 2.975 8.525 3.125 8.75 3.275V5.75H7.775C7.55 5.3 7.025 5 6.5 5C5.675 5 5 5.675 5 6.5C5 7.025 5.3 7.55 5.75 7.775V8.75H3.275ZM8.75 8.225C8.525 8.375 8.375 8.525 8.225 8.75H7.25V7.775C7.475 7.625 7.625 7.475 7.775 7.25H8.75V8.225ZM8.225 10.25C8.45 10.7 8.975 11 9.5 11C10.325 11 11 10.325 11 9.5C11 8.975 10.7 8.45 10.25 8.225V7.25H12.725C12.875 7.475 13.025 7.625 13.25 7.775V12.725C13.025 12.875 12.875 13.025 12.725 13.25H7.775C7.625 13.025 7.475 12.875 7.25 12.725V10.25H8.225Z"
            fill="#50A5F1" />
        </svg>
        <span style="margin-right: 1rem; margin-left: 8px;">{{t('code')}}:</span>
        <span class="text-link">{{dataFromParent.codeRole}}</span>
      </span>
      <span class="fw-600">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M14.75 12.725V7.775C15.2 7.55 15.5 7.025 15.5 6.5C15.5 5.675 14.825 5 14 5C13.475 5 12.95 5.3 12.725 5.75H10.25V3.275C10.7 3.05 11 2.525 11 2C11 1.175 10.325 0.5 9.5 0.5C8.975 0.5 8.45 0.8 8.225 1.25H3.275C3.05 0.8 2.525 0.5 2 0.5C1.175 0.5 0.5 1.175 0.5 2C0.5 2.525 0.8 3.05 1.25 3.275V8.225C0.8 8.45 0.5 8.975 0.5 9.5C0.5 10.325 1.175 11 2 11C2.525 11 3.05 10.7 3.275 10.25H5.75V12.725C5.3 12.95 5 13.475 5 14C5 14.825 5.675 15.5 6.5 15.5C7.025 15.5 7.55 15.2 7.775 14.75H12.725C12.95 15.2 13.475 15.5 14 15.5C14.825 15.5 15.5 14.825 15.5 14C15.5 13.475 15.2 12.95 14.75 12.725ZM3.275 8.75C3.125 8.525 2.975 8.375 2.75 8.225V3.275C2.975 3.125 3.125 2.975 3.275 2.75H8.225C8.375 2.975 8.525 3.125 8.75 3.275V5.75H7.775C7.55 5.3 7.025 5 6.5 5C5.675 5 5 5.675 5 6.5C5 7.025 5.3 7.55 5.75 7.775V8.75H3.275ZM8.75 8.225C8.525 8.375 8.375 8.525 8.225 8.75H7.25V7.775C7.475 7.625 7.625 7.475 7.775 7.25H8.75V8.225ZM8.225 10.25C8.45 10.7 8.975 11 9.5 11C10.325 11 11 10.325 11 9.5C11 8.975 10.7 8.45 10.25 8.225V7.25H12.725C12.875 7.475 13.025 7.625 13.25 7.775V12.725C13.025 12.875 12.875 13.025 12.725 13.25H7.775C7.625 13.025 7.475 12.875 7.25 12.725V10.25H8.225Z"
            fill="#50A5F1" />
        </svg>
        <span style="margin-right: 1rem; margin-left: 8px;">{{t('role.layout')}}:</span>
        <span class="text-link">{{mapNameLayout()}}</span>
      </span>
    </div>
    <div class="mb-6"
      *ngIf="dataFromParent.layoutCode == 'teacher' || dataFromParent.layoutCode == 'staff' || dataFromParent.layoutCode == 'student'">
      <div class="d-flex">
        <label for="school" style="margin-right: 1.2rem; min-width: max-content;"
          class="fw-600 mt-3">{{t('role.selectSchool')}} <span class="text-danger">*</span></label>
        <div class="flex-grow-1">
          <select [(ngModel)]="schoolId" class="so-select w-full so-form-control" name="school" #school="ngModel" required
            [class.is-invalid]="(dataFromParent.layoutCode == 'teacher' || dataFromParent.layoutCode == 'staff' || dataFromParent.layoutCode == 'student') && schoolId == null && (school.dirty || school.touched)"
          >
            <option [value]="null" disabled>{{t('role.selectSchool')}}</option>
            <option *ngFor="let item of arrSchools" [value]="item.id">{{item.name}}</option>
          </select>
          <ng-container
            *ngIf="(dataFromParent.layoutCode == 'teacher' || dataFromParent.layoutCode == 'staff' || dataFromParent.layoutCode == 'student') && schoolId == null && (school.dirty || school.touched)">
            <div class="fv-plugins-message-container">
              <span role="alert">
                <div class="err-form text-danger">
                  <span>&nbsp;{{t('role.warmingSelectSchool')}}</span>
                </div>
              </span>
            </div>
          </ng-container>
        </div>
      </div>

    </div>
    <div class="mb-6" *ngIf="dataFromParent.layoutCode == 'campus'">
      <div class="d-flex">
        <label for="campus" style="margin-right: 1.2rem; min-width: max-content;"
          class="fw-600 mt-3">{{t('role.selectCampus')}} <span class="text-danger">*</span></label>
        <div class="flex-grow-1">
          <select [(ngModel)]="campusId" class="so-select w-full so-form-control" name="campus" #campus="ngModel" required
            [class.is-invalid]="dataFromParent.layoutCode == 'campus' && campusId == null && (campus.dirty || campus.touched)"
          >
            <option [value]="null" disabled>{{t('role.selectCampus')}}</option>
            <option *ngFor="let item of arrCampus" [value]="item.id">{{item.name}}</option>
          </select>
          <ng-container
            *ngIf="dataFromParent.layoutCode == 'campus' && campusId == null && (campus.dirty || campus.touched)">
            <div class="fv-plugins-message-container">
              <span role="alert">
                <div class="err-form text-danger">
                  <span>&nbsp;{{t('role.warmingSelectCampus')}}</span>
                </div>
              </span>
            </div>
          </ng-container>
        </div>
      </div>
    </div>
    <div class="mt-4">
      <div class="d-inline-flex align-items-center justify-content-between w-full flex-wrap">
        <div class="d-inline-flex align-items-center ms-7 mb-3 fw-600">
          {{t('select')}}
          <span class="mx-12">{{t('selected')}}: <span class="text-link fw-600">{{listUserIdSubmit.length}}
              {{t('user').toLowerCase()}}</span></span>
        </div>
        <div class="so-input-search mb-3">
          <input type="text" placeholder="{{ t('role.search') }}" #searchInput name="input-search"
            (keydown)="search($event, searchInput.value)">
          <img src="assets/images/svg/search.svg" alt="" nzType="search" (click)="searchClickIcon(searchInput.value)" />
        </div>
      </div>

      <div class="table-responsive mt-5">
        <table class="table table-row-bordered table-row-gray-300">
          <caption></caption>
          <thead>
            <tr class="fs-14 fw-700 text-color-river-bed">
              <th style="width: 5%;" class="text-center">
                <div class="d-flex justify-content-center">
                  <label nz-checkbox class="so-checkbox" name="checkbox-all" [(ngModel)]="isCheckAll" [nzValue]="null"
                    [nzDisabled]="listUsers.length == 0 || !listUsers" (ngModelChange)="checkedAll($event)">
                  </label>
                </div>
              </th>
              <th style="width: 5%;" class="text-center">{{t('STT')}}</th>
              <th style="width: 20%;"> {{t('role.nameUser')}}</th>
              <th style="width: 10%;"> {{t('code')}} </th>
              <th style="width: 10%;"> {{t('account')}} </th>
              <th style="width: 12%;"> {{t('phone')}} </th>
              <th style="width: 15%;"> {{t('email')}} </th>
              <th style="width: 8%;"> {{t('status')}} </th>
            </tr>
          </thead>
          <tbody>
            <ng-container *ngFor="let item of listUsers; let i=index">
              <tr class="fs-13 fw-600 text-color-river-bed">
                <td class="text-center" style="width: 7%">
                  <div class="d-flex justify-content-center">
                    <label nz-checkbox class="so-checkbox" name="checkbox-user" [(ngModel)]="item.isChecked"
                      [nzValue]="item.id" (ngModelChange)="checked($event, item)">
                    </label>
                  </div>
                </td>
                <td class="text-center">
                  {{isLoading ? (oldPageIndex-1)*pageSize + i + 1 : (pageIndex-1)*pageSize + i + 1}}
                </td>
                <td>
                  <span class="fw-700">{{item.fullName}}</span>
                </td>
                <td>
                  {{item.code}}
                </td>
                <td>
                  {{item.username}}
                </td>
                <td>
                  {{item.phone}}
                </td>
                <td>
                  {{item.email}}
                </td>
                <td>
                  <span class="badge so-badge so-badge--primary so-badge-status-{{item?.isActive}}">
                    {{t(mapNameStatus(item?.isActive))}}
                  </span>
                </td>
              </tr>
            </ng-container>
            <tr *ngIf="listUsers?.length == 0 || !listUsers">
              <td class="text-no-data" colspan="8">{{t('noData')}}</td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="mt-5" *ngIf="collectionSize > sizeOption[0]">
        <app-pagination [pageSize]="pageSize" [pageIndex]="pageIndex" [collectionSize]="collectionSize"
          [sizeOption]="sizeOption" (paginationChange)="paginationChange($event)">
        </app-pagination>
      </div>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="so-btn so-btn-cancel" data-dismiss="modal" name="btn-cancel"
      (click)="closeModal(false)">{{t(dataModal?.btnCancel)}}</button>
    <button type="button" class="so-btn so-btn-primary so-btn-primary--small" name="btn-accept" (click)="submit()">
      {{t(dataModal?.btnAccept)}}
    </button>
  </div>
</ng-container>

<div class="spinner" *ngIf="isLoading">
  <app-loading></app-loading>
</div>
